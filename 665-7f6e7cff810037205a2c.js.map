{"version":3,"file":"665-7f6e7cff810037205a2c.js","mappings":"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","sources":["webpack://alexdanieldm.com/../src/components/intersection-observer.ts","webpack://alexdanieldm.com/../src/components/lazy-hydrate.tsx","webpack://alexdanieldm.com/./node_modules/preact-render-to-string/dist/index.mjs"],"sourcesContent":["let intersectionObserver: IntersectionObserver\n\nexport type Unobserver = () => void\n\nconst ioEntryMap = new WeakMap<HTMLElement, () => void>()\n/* eslint-disable @typescript-eslint/no-explicit-any  */\nconst connection =\n  (navigator as any).connection ||\n  (navigator as any).mozConnection ||\n  (navigator as any).webkitConnection\n/* eslint-enable @typescript-eslint/no-explicit-any */\n\n// These match the thresholds used in Chrome's native lazy loading\n// @see https://web.dev/browser-level-image-lazy-loading/#distance-from-viewport-thresholds\nconst FAST_CONNECTION_THRESHOLD = `1250px`\nconst SLOW_CONNECTION_THRESHOLD = `2500px`\n\nexport function createIntersectionObserver(\n  callback: () => void\n): (element: HTMLElement) => Unobserver {\n  const connectionType = connection?.effectiveType\n\n  // if we don't support intersectionObserver we don't lazy load (Sorry IE 11).\n  if (!(`IntersectionObserver` in window)) {\n    return function observe(): Unobserver {\n      callback()\n      return function unobserve(): void {}\n    }\n  }\n\n  if (!intersectionObserver) {\n    intersectionObserver = new IntersectionObserver(\n      entries => {\n        entries.forEach(entry => {\n          if (entry.isIntersecting) {\n            // Get the matching entry's callback and call it\n            ioEntryMap.get(entry.target as HTMLElement)?.()\n            // We only need to call it once\n            ioEntryMap.delete(entry.target as HTMLElement)\n          }\n        })\n      },\n      {\n        rootMargin:\n          connectionType === `4g` && !connection?.saveData\n            ? FAST_CONNECTION_THRESHOLD\n            : SLOW_CONNECTION_THRESHOLD,\n      }\n    )\n  }\n\n  return function observe(element: HTMLElement): Unobserver {\n    // Store a reference to the callback mapped to the element being watched\n    ioEntryMap.set(element, callback)\n    intersectionObserver.observe(element)\n\n    return function unobserve(): void {\n      if (intersectionObserver && element) {\n        ioEntryMap.delete(element)\n        intersectionObserver.unobserve(element)\n      }\n    }\n  }\n}\n","import React from \"react\"\nimport { renderToStaticMarkup } from \"react-dom/server\"\nimport { LayoutWrapper } from \"./layout-wrapper\"\nimport { Placeholder } from \"./placeholder\"\nimport { MainImage } from \"./main-image\"\nimport {\n  hasNativeLazyLoadSupport,\n  getMainProps,\n  getPlaceholderProps,\n} from \"./hooks\"\nimport { createIntersectionObserver } from \"./intersection-observer\"\nimport type { MainImageProps } from \"./main-image\"\nimport type { GatsbyImageProps } from \"./gatsby-image.browser\"\n\ntype LazyHydrateProps = Omit<GatsbyImageProps, \"as\" | \"style\" | \"className\"> & {\n  isLoading: boolean\n  isLoaded: boolean\n}\n\nasync function applyPolyfill(element: HTMLImageElement): Promise<void> {\n  if (!(`objectFitPolyfill` in window)) {\n    await import(\n      // @ts-ignore typescript can't find the module for some reason ¯\\_(ツ)_/¯\n      /* webpackChunkName: \"gatsby-plugin-image-objectfit-polyfill\" */ `objectFitPolyfill`\n    )\n  }\n  ;(window as any).objectFitPolyfill(element)\n}\n\nfunction toggleLoaded(\n  mainImage: HTMLElement,\n  placeholderImage: HTMLElement\n): void {\n  mainImage.style.opacity = `1`\n\n  if (placeholderImage) {\n    placeholderImage.style.opacity = `0`\n  }\n}\n\nfunction startLoading(\n  element: HTMLElement,\n  cacheKey: string,\n  imageCache: Set<string>,\n  onStartLoad: GatsbyImageProps[\"onStartLoad\"],\n  onLoad: GatsbyImageProps[\"onLoad\"],\n  onError: GatsbyImageProps[\"onError\"]\n): () => void {\n  const mainImage = element.querySelector(\n    `[data-main-image]`\n  ) as HTMLImageElement\n  const placeholderImage = element.querySelector<HTMLElement>(\n    `[data-placeholder-image]`\n  )\n  const isCached = imageCache.has(cacheKey)\n\n  function onImageLoaded(e): void {\n    // eslint-disable-next-line @babel/no-invalid-this\n    this.removeEventListener(`load`, onImageLoaded)\n\n    const target = e.currentTarget\n    const img = new Image()\n    img.src = target.currentSrc\n\n    if (img.decode) {\n      // Decode the image through javascript to support our transition\n      img\n        .decode()\n        .then(() => {\n          // eslint-disable-next-line @babel/no-invalid-this\n          toggleLoaded(this, placeholderImage)\n          onLoad?.({\n            wasCached: isCached,\n          })\n        })\n        .catch(e => {\n          // eslint-disable-next-line @babel/no-invalid-this\n          toggleLoaded(this, placeholderImage)\n          onError?.(e)\n        })\n    } else {\n      // eslint-disable-next-line @babel/no-invalid-this\n      toggleLoaded(this, placeholderImage)\n      onLoad?.({\n        wasCached: isCached,\n      })\n    }\n  }\n\n  mainImage.addEventListener(`load`, onImageLoaded)\n\n  onStartLoad?.({\n    wasCached: isCached,\n  })\n  Array.from(mainImage.parentElement.children).forEach(child => {\n    const src = child.getAttribute(`data-src`)\n    const srcSet = child.getAttribute(`data-srcset`)\n    if (src) {\n      child.removeAttribute(`data-src`)\n      child.setAttribute(`src`, src)\n    }\n    if (srcSet) {\n      child.removeAttribute(`data-srcset`)\n      child.setAttribute(`srcset`, srcSet)\n    }\n  })\n\n  imageCache.add(cacheKey)\n\n  // Load times not always fires - mostly when it's a 304\n  // We check if the image is already completed and if so we trigger onload.\n  if (mainImage.complete) {\n    onImageLoaded.call(mainImage, {\n      currentTarget: mainImage,\n    })\n  }\n\n  return (): void => {\n    if (mainImage) {\n      mainImage.removeEventListener(`load`, onImageLoaded)\n    }\n  }\n}\n\nexport function swapPlaceholderImage(\n  element: HTMLElement,\n  cacheKey: string,\n  imageCache: Set<string>,\n  style: React.CSSProperties,\n  onStartLoad: GatsbyImageProps[\"onStartLoad\"],\n  onLoad: GatsbyImageProps[\"onLoad\"],\n  onError: GatsbyImageProps[\"onError\"]\n): () => void {\n  if (!hasNativeLazyLoadSupport()) {\n    let cleanup\n    const io = createIntersectionObserver(() => {\n      cleanup = startLoading(\n        element,\n        cacheKey,\n        imageCache,\n        onStartLoad,\n        onLoad,\n        onError\n      )\n    })\n    const unobserve = io(element)\n\n    // Polyfill \"object-fit\" if unsupported (mostly IE)\n    if (!(`objectFit` in document.documentElement.style)) {\n      element.dataset.objectFit = style.objectFit ?? `cover`\n      element.dataset.objectPosition = `${style.objectPosition ?? `50% 50%`}`\n      applyPolyfill(element as HTMLImageElement)\n    }\n\n    return (): void => {\n      if (cleanup) {\n        cleanup()\n      }\n\n      unobserve()\n    }\n  }\n\n  return startLoading(\n    element,\n    cacheKey,\n    imageCache,\n    onStartLoad,\n    onLoad,\n    onError\n  )\n}\n\nexport function renderImageToString({\n  image,\n  loading = `lazy`,\n  isLoading,\n  isLoaded,\n  imgClassName,\n  imgStyle = {},\n  objectPosition,\n  backgroundColor,\n  objectFit = `cover`,\n  ...props\n}: LazyHydrateProps): string {\n  const {\n    width,\n    height,\n    layout,\n    images,\n    placeholder,\n    backgroundColor: wrapperBackgroundColor,\n  } = image\n\n  imgStyle = {\n    objectFit,\n    objectPosition,\n    backgroundColor,\n    ...imgStyle,\n  }\n\n  return renderToStaticMarkup(\n    <LayoutWrapper layout={layout} width={width} height={height}>\n      <Placeholder\n        {...getPlaceholderProps(\n          placeholder,\n          isLoaded,\n          layout,\n          width,\n          height,\n          wrapperBackgroundColor,\n          objectFit,\n          objectPosition\n        )}\n      />\n\n      <MainImage\n        {...(props as Omit<\n          MainImageProps,\n          \"images\" | \"fallback\" | \"onLoad\" | \"onError\"\n        >)}\n        width={width}\n        height={height}\n        className={imgClassName}\n        {...getMainProps(isLoading, isLoaded, images, loading, imgStyle)}\n      />\n    </LayoutWrapper>\n  )\n}\n","import{options as e,Fragment as t}from\"preact\";var r=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,n=/[&<>\"]/;function o(e){var t=String(e);return n.test(t)?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\"):t}var a=function(e,t){return String(e).replace(/(\\n+)/g,\"$1\"+(t||\"\\t\"))},i=function(e,t,r){return String(e).length>(t||40)||!r&&-1!==String(e).indexOf(\"\\n\")||-1!==String(e).indexOf(\"<\")},l={};function s(e){var t=\"\";for(var n in e){var o=e[n];null!=o&&\"\"!==o&&(t&&(t+=\" \"),t+=\"-\"==n[0]?n:l[n]||(l[n]=n.replace(/([A-Z])/g,\"-$1\").toLowerCase()),t+=\": \",t+=o,\"number\"==typeof o&&!1===r.test(n)&&(t+=\"px\"),t+=\";\")}return t||void 0}function f(e,t){for(var r in t)e[r]=t[r];return e}function u(e,t){return Array.isArray(t)?t.reduce(u,e):null!=t&&!1!==t&&e.push(t),e}var c={shallow:!0},p=[],_=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,v=/[\\s\\n\\\\/='\"\\0<>]/,d=function(){};m.render=m;var g=function(e,t){return m(e,t,c)},h=[];function m(t,r,n){r=r||{},n=n||{};var o=e.__s;e.__s=!0;var a=x(t,r,n);return e.__c&&e.__c(t,h),h.length=0,e.__s=o,a}function x(r,n,l,c,g,h){if(null==r||\"boolean\"==typeof r)return\"\";if(\"object\"!=typeof r)return o(r);var m=l.pretty,y=m&&\"string\"==typeof m?m:\"\\t\";if(Array.isArray(r)){for(var b=\"\",S=0;S<r.length;S++)m&&S>0&&(b+=\"\\n\"),b+=x(r[S],n,l,c,g,h);return b}var w,k=r.type,O=r.props,C=!1;if(\"function\"==typeof k){if(C=!0,!l.shallow||!c&&!1!==l.renderRootComponent){if(k===t){var A=[];return u(A,r.props.children),x(A,n,l,!1!==l.shallowHighOrder,g,h)}var H,j=r.__c={__v:r,context:n,props:r.props,setState:d,forceUpdate:d,__h:[]};if(e.__b&&e.__b(r),e.__r&&e.__r(r),k.prototype&&\"function\"==typeof k.prototype.render){var F=k.contextType,M=F&&n[F.__c],T=null!=F?M?M.props.value:F.__:n;(j=r.__c=new k(O,T)).__v=r,j._dirty=j.__d=!0,j.props=O,null==j.state&&(j.state={}),null==j._nextState&&null==j.__s&&(j._nextState=j.__s=j.state),j.context=T,k.getDerivedStateFromProps?j.state=f(f({},j.state),k.getDerivedStateFromProps(j.props,j.state)):j.componentWillMount&&(j.componentWillMount(),j.state=j._nextState!==j.state?j._nextState:j.__s!==j.state?j.__s:j.state),H=j.render(j.props,j.state,j.context)}else{var $=k.contextType,L=$&&n[$.__c];H=k.call(r.__c,O,null!=$?L?L.props.value:$.__:n)}return j.getChildContext&&(n=f(f({},n),j.getChildContext())),e.diffed&&e.diffed(r),x(H,n,l,!1!==l.shallowHighOrder,g,h)}k=(w=k).displayName||w!==Function&&w.name||function(e){var t=(Function.prototype.toString.call(e).match(/^\\s*function\\s+([^( ]+)/)||\"\")[1];if(!t){for(var r=-1,n=p.length;n--;)if(p[n]===e){r=n;break}r<0&&(r=p.push(e)-1),t=\"UnnamedComponent\"+r}return t}(w)}var E,D,N=\"<\"+k;if(O){var P=Object.keys(O);l&&!0===l.sortAttributes&&P.sort();for(var R=0;R<P.length;R++){var U=P[R],W=O[U];if(\"children\"!==U){if(!v.test(U)&&(l&&l.allAttributes||\"key\"!==U&&\"ref\"!==U&&\"__self\"!==U&&\"__source\"!==U&&\"defaultValue\"!==U)){if(\"className\"===U){if(O.class)continue;U=\"class\"}else g&&U.match(/^xlink:?./)&&(U=U.toLowerCase().replace(/^xlink:?/,\"xlink:\"));if(\"htmlFor\"===U){if(O.for)continue;U=\"for\"}\"style\"===U&&W&&\"object\"==typeof W&&(W=s(W)),\"a\"===U[0]&&\"r\"===U[1]&&\"boolean\"==typeof W&&(W=String(W));var q=l.attributeHook&&l.attributeHook(U,W,n,l,C);if(q||\"\"===q)N+=q;else if(\"dangerouslySetInnerHTML\"===U)D=W&&W.__html;else if(\"textarea\"===k&&\"value\"===U)E=W;else if((W||0===W||\"\"===W)&&\"function\"!=typeof W){if(!(!0!==W&&\"\"!==W||(W=U,l&&l.xml))){N+=\" \"+U;continue}if(\"value\"===U){if(\"select\"===k){h=W;continue}\"option\"===k&&h==W&&(N+=\" selected\")}N+=\" \"+U+'=\"'+o(W)+'\"'}}}else E=W}}if(m){var z=N.replace(/\\n\\s*/,\" \");z===N||~z.indexOf(\"\\n\")?m&&~N.indexOf(\"\\n\")&&(N+=\"\\n\"):N=z}if(N+=\">\",v.test(k))throw new Error(k+\" is not a valid HTML tag name in \"+N);var I,V=_.test(k)||l.voidElements&&l.voidElements.test(k),Z=[];if(D)m&&i(D)&&(D=\"\\n\"+y+a(D,y)),N+=D;else if(null!=E&&u(I=[],E).length){for(var B=m&&~N.indexOf(\"\\n\"),G=!1,J=0;J<I.length;J++){var K=I[J];if(null!=K&&!1!==K){var Q=x(K,n,l,!0,\"svg\"===k||\"foreignObject\"!==k&&g,h);if(m&&!B&&i(Q)&&(B=!0),Q)if(m){var X=Q.length>0&&\"<\"!=Q[0];G&&X?Z[Z.length-1]+=Q:Z.push(Q),G=X}else Z.push(Q)}}if(m&&B)for(var Y=Z.length;Y--;)Z[Y]=\"\\n\"+y+a(Z[Y],y)}if(Z.length||D)N+=Z.join(\"\");else if(l&&l.xml)return N.substring(0,N.length-1)+\" />\";return!V||I||D?(m&&~N.indexOf(\"\\n\")&&(N+=\"\\n\"),N+=\"</\"+k+\">\"):N=N.replace(/>$/,\" />\"),N}m.shallowRender=g;export default m;export{m as render,m as renderToStaticMarkup,m as renderToString,g as shallowRender};\n//# sourceMappingURL=index.module.js.map\n"],"names":["d","u","WeakMap","m","navigator","connection","mozConnection","webkitConnection","g","b","e","t","style","opacity","h","o","n","r","a","i","querySelector","c","s","has","l","this","removeEventListener","currentTarget","Image","src","currentSrc","decode","then","wasCached","catch","addEventListener","Array","from","parentElement","children","forEach","getAttribute","removeAttribute","setAttribute","add","complete","call","v","callback","window","IntersectionObserver","isIntersecting","get","target","delete","rootMargin","effectiveType","saveData","set","observe","unobserve","document","documentElement","dataset","objectFit","objectPosition","async","objectFitPolyfill","f","image","loading","isLoading","isLoaded","imgClassName","imgStyle","backgroundColor","p","y","w","width","j","height","C","layout","E","images","F","placeholder","P","L","className","String","test","replace","length","indexOf","toLowerCase","isArray","reduce","push","shallow","_","render","__s","x","__c","pretty","S","k","type","O","props","renderRootComponent","A","shallowHighOrder","H","__v","context","setState","forceUpdate","__h","__b","__r","prototype","contextType","M","T","value","__","_dirty","__d","state","_nextState","getDerivedStateFromProps","componentWillMount","$","getChildContext","diffed","displayName","Function","name","toString","match","D","N","Object","keys","sortAttributes","sort","R","U","W","allAttributes","class","for","q","attributeHook","__html","xml","z","Error","I","V","voidElements","Z","B","G","J","K","Q","X","Y","join","substring","shallowRender"],"sourceRoot":""}